# 👁️ Gaze Scroll - 눈 시선 스크롤 크롬 확장 프로그램

눈 시선으로 웹페이지를 위아래로 스크롤할 수 있는 혁신적인 크롬 확장 프로그램입니다.

## ✨ 기능

- **🧠 AI 기반 눈 시선 추적**: MediaPipe Face Mesh를 활용한 정밀한 468개 얼굴 랜드마크 기반 시선 추적
- **🔄 하이브리드 감지 시스템**: MediaPipe와 기본 알고리즘을 결합하여 최적의 성능과 호환성 보장
- **👁️ 정밀한 눈 감지**: 실시간 눈꺼풀 상태, 눈 열림 정도, 시선 방향을 정확하게 분석
- **⚡ 자동 스크롤**: 화면 상단을 바라보면 위로, 하단을 바라보면 아래로 부드러운 자동 스크롤
- **⚙️ 사용자 정의 설정**: 스크롤 속도와 감도 영역을 세밀하게 조절 가능
- **🎯 스마트 보정**: AI 기반 자동 캘리브레이션으로 정확한 추적
- **🎨 실시간 디버그**: 얼굴 랜드마크, 눈 영역, 시선 방향을 실시간으로 시각화
- **📺 PIP 모드**: Picture-in-Picture 독립 창으로 다른 작업 중에도 시선 추적 모니터링
- **🖥️ 직관적인 UI**: 아름다운 인터페이스로 쉽게 제어

## 🚀 설치 방법

### 1단계: 크롬 확장 프로그램 개발자 모드 활성화

- 크롬 브라우저를 열고 주소창에 `chrome://extensions/` 입력
- 우측 상단의 "개발자 모드" 토글을 활성화

### 2단계: 확장 프로그램 로드

- "압축해제된 확장 프로그램을 로드합니다" 버튼 클릭
- 파일 탐색기에서 이 프로젝트 폴더 (`gaze-scroll`) 선택
- "폴더 선택" 버튼 클릭

### 3단계: 확장 프로그램 확인

- 확장 프로그램 목록에서 "Gaze Scroll - 눈 시선 스크롤"이 추가된 것을 확인
- 확장 프로그램 아이콘 (👁️)이 브라우저 우측 상단에 나타남

### 4단계: 카메라 권한 허용

- 확장 프로그램 아이콘을 클릭하여 팝업 창 열기
- "시선 추적 시작" 버튼 클릭
- 브라우저가 카메라 권한을 요청하면 "허용" 버튼 클릭

## ⚠️ 중요 사항

- **카메라 권한은 필수입니다**: 확장 프로그램이 카메라를 통해 시선 위치를 감지해야 합니다
- **조명 조건**: 충분한 조명에서 더 정확한 추적이 가능합니다
- **브라우저 호환성**: Chrome 브라우저에서 최적화되어 있습니다

## 📖 사용 방법

1. **확장 프로그램 실행**

   - 크롬 우측 상단의 확장 프로그램 아이콘 클릭
   - Gaze Scroll 아이콘 클릭

2. **시선 추적 시작**

   - "시선 추적 시작" 버튼 클릭
   - 카메라가 활성화되고 시선 추적이 시작됩니다

3. **눈 위치 보정 (선택사항)**

   - "눈 위치 보정" 버튼을 클릭
   - 화면에 나타나는 점들을 차례대로 바라봅니다

4. **스크롤 설정 조절**

   - 스크롤 속도: 스크롤 속도를 조절 (10-200)
   - 상단 영역: 위쪽 스크롤 감도 영역 (%) (10-45)
   - 하단 영역: 아래쪽 스크롤 감도 영역 (%) (10-45)
   - 디버그 모드: 시선 추적 디버깅 기능 활성화
   - 좌우 반전: 카메라 화면 좌우 반전 모드

5. **디버그 모드 사용 (선택사항)**

   - 시선 추적을 시작하면 자동으로 디버그 패널에 실시간 정보 표시
   - **🧠 AI 감지 상태**: MediaPipe Face Mesh 초기화 및 랜드마크 감지 상태
   - **👁️ 468개 랜드마크**: 얼굴의 정밀한 특징점들을 실시간으로 추적
   - **🎯 정밀한 시선 추적**: 눈꺼풀 상태, 눈 열림 정도, 시선 방향을 정확하게 분석
   - **🔄 하이브리드 시스템**: MediaPipe와 기본 알고리즘 자동 전환
   - **📊 실시간 메트릭**:
     - 감지 방식 (MediaPipe Face Mesh / 기본)
     - MediaPipe 상태 (초기화됨, 활성, 랜드마크 개수)
     - 눈 추적 품질 및 신뢰도
     - 얼굴 영역 및 피부톤 픽셀 분석
     - 눈꺼풀 열림 정도
     - 시선 방향 및 스크롤 상태
   - **🎨 시각화**:
     - 노란색 사각형: 얼굴 영역 감지
     - 녹색/파란색 사각형: 왼쪽/오른쪽 눈 영역
     - 동그란 눈동자 모양: 눈 중심점 표시
     - 빨간 십자가: 현재 시선 방향

6. **📺 PIP 모드 사용 (선택사항)**

   - **PIP 모드 버튼**: "📺 PIP 모드" 버튼을 클릭하여 독립 창 열기
   - **독립 모니터링**: 다른 작업을 하면서도 시선 추적 상태를 실시간으로 확인
   - **PIP 창 특징**:
     - 화면 우측 상단에 400x350 크기로 표시
     - 실시간 카메라 영상과 MediaPipe 랜드마크
     - 눈 영역 하이라이트 (청록색)
     - 시선 방향 표시 (빨간 십자가)
     - 추적 상태, 감지 방식, 시선 위치, 스크롤 방향 실시간 표시
   - **창 제어**:
     - 우측 상단 ✕ 버튼으로 닫기
     - 크기 조절 가능 (resizable)
     - 팝업 창이 닫히면 자동으로 PIP 창도 닫힘
   - **용도**: 브라우징, 문서 작업, 동영상 시청 중에도 시선 추적 상태 모니터링

7. **스크롤 사용**
   - 화면 상단 30% 영역을 바라보면 위로 스크롤
   - 화면 하단 30% 영역을 바라보면 아래로 스크롤
   - 중앙 영역을 바라보면 스크롤 정지

## ⚙️ 설정 설명

### 스크롤 속도

- **범위**: 10 ~ 200
- **기본값**: 50
- 값이 클수록 빠른 스크롤 속도

### 감도 영역 (%)

- **상단 영역**: 화면 위쪽에서 시선이 감지되는 영역 비율
- **하단 영역**: 화면 아래쪽에서 시선이 감지되는 영역 비율
- **중앙 영역**: 스크롤이 정지되는 영역

### 디버그 모드

- **설명**: 실시간 카메라 화면과 시선 추적 정보를 표시
- **기능**:
  - 📹 실시간 카메라 화면 표시 (메인 기능과 공유)
  - 🔄 **좌우 반전 모드**: 카메라 화면 좌우 반전으로 자연스러운 시선 관찰
  - 🔍 **자동 줌 기능**: 눈 영역을 자동으로 찾아 확대 표시
  - 🎚️ **줌 레벨 조절**: 1x ~ 4x까지 수동 줌 조절 가능
  - 👁️ **지능적 눈 추적**: 얼굴 인식 후 눈 위치 자동 추정 및 추적
  - 🎯 시선 방향 시각화 (빨간 선과 점)
  - 📊 밝기 차이, 스크롤 방향, 가속도 실시간 표시
  - 🔧 카메라 권한 문제 자동 해결
  - 🎨 **눈 영역 클로즈업**: 눈 부분만 크게 확대해서 세밀한 관찰 가능
  - 🎯 **눈 중앙 맞추기**: 눈 위치를 다시 찾아서 중앙에 맞추는 기능
- **용도**: 시선 추적 정확도 확인 및 디버깅
- **특징**: 메인 시선 추적 기능과 카메라 스트림을 공유하여 권한 충돌 방지
- **기본값**: 비활성화

## 🔧 기술 스택

- **🧠 MediaPipe Face Mesh**: Google의 AI 기반 468개 얼굴 랜드마크 감지 라이브러리
- **📷 MediaDevices API & Canvas API**: 시선 추적을 위한 카메라 및 이미지 처리
- **🚀 Chrome Extension Manifest V3**: 최신 크롬 확장 프로그램 표준
- **💻 HTML/CSS/JavaScript**: 프론트엔드 구현
- **🔄 하이브리드 알고리즘**: MediaPipe + 커스텀 이미지 분석 알고리즘 결합

## 🐛 문제 해결

### "A listener indicated an asynchronous response by returning true, but the message channel closed before a response was received"

- **원인**: Chrome 확장 프로그램의 메시지 채널이 닫히는 경우 발생
- **해결책**:
  1. 페이지를 새로고침 (Ctrl+F5)
  2. 확장 프로그램을 다시 로드
  3. 브라우저를 재시작

### "카메라 권한이 거부되었습니다"

- **해결책**:
  1. 주소창 왼쪽 카메라 아이콘 클릭
  2. "항상 허용" 선택
  3. 페이지 새로고침 후 다시 시도

### 디버그 모드에서 "카메라 권한이 없습니다"

- **해결책**:
  1. 먼저 메인 "시선 추적 시작" 버튼을 클릭
  2. 카메라 권한 허용
  3. 그 후 디버그 모드 활성화

### 확장 프로그램이 작동하지 않음

- **해결책**:
  1. `chrome://extensions/` 열기
  2. Gaze Scroll 확장 프로그램 찾기
  3. 🔄 새로고침 버튼 클릭
  4. 팝업 다시 열기

## 📝 주의사항

- **카메라 권한 필수**: 확장 프로그램 사용을 위해 카메라 권한이 필요합니다
- **조명 조건**: 충분한 조명에서 더 정확한 추적이 가능합니다
- **브라우저 호환성**: Chrome 브라우저에서 최적화되어 있습니다
- **성능 고려**: 시선 추적은 CPU 리소스를 사용하므로 배터리 소모가 있을 수 있습니다
- **메시지 채널**: 페이지 새로고침 시 메시지 채널이 초기화되므로 다시 시작해주세요

## 🛠️ 개발 정보

### 파일 구조

```
/Users/yong/gaze-scroll/
├── manifest.json          # 확장 프로그램 설정
├── popup.html            # 확장 프로그램 UI
├── popup.js              # UI 제어 로직
├── background.js         # 백그라운드 서비스
├── content.js            # 웹페이지에 삽입되는 메인 스크립트
└── README.md             # 이 파일
```

### 주요 컴포넌트

- **GazeScroll 클래스**: 메인 시선 추적 및 스크롤 로직
- **Popup 인터페이스**: 사용자 설정 및 제어 인터페이스
- **Content Script**: 웹페이지에 삽입되어 실제 기능 수행

## 🎯 향후 개선 계획

- [x] ✅ **MediaPipe Face Mesh 통합**: AI 기반 정밀한 얼굴 랜드마크 감지 완료
- [x] ✅ **하이브리드 감지 시스템**: MediaPipe + 기본 알고리즘 결합 완료
- [x] ✅ **실시간 눈꺼풀 상태 감지**: 눈 열림/감김 상태 인식 완료
- [x] ✅ **정밀한 시선 방향 계산**: 468개 랜드마크 기반 시선 추정 완료
- [x] ✅ **PIP 모드**: Picture-in-Picture 독립 창으로 다른 작업 중 모니터링 완료
- [ ] 🔄 **동공 추적 기능**: MediaPipe Iris를 활용한 동공 중심점 추적
- [ ] 📱 **모바일 최적화**: 터치 디바이스용 제스처 기반 스크롤
- [ ] 🌐 **다양한 스크롤 모드**: 좌우 스크롤, 줌 인/아웃, 페이지 이동
- [ ] 🎤 **음성 명령 지원**: "스크롤 시작/정지" 음성 제어
- [ ] 🖥️ **다중 모니터 지원**: 멀티 디스플레이 환경 최적화
- [ ] ☁️ **설정 동기화**: 클라우드 기반 사용자 설정 저장

## 📄 라이선스

이 프로젝트는 MIT 라이선스 하에 배포됩니다.

## 🤝 기여

버그 리포트, 기능 제안, 코드 기여를 환영합니다!

---

**즐거운 시선 스크롤 경험 되세요! 👁️📜**
